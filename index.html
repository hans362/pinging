<!DOCTYPE html>
<html>

<head>
  <title>Pinging</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.1.2/dist/echarts.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
</head>

<body>
  <div id="main" class="chart" style="width: 100%;height: 400px;"></div>
  <script>
    var chart = echarts.init(document.getElementById("main"));
    chart.showLoading();
    const by = new URLSearchParams(window.location.search).get('by') || 'agent';
    const id = new URLSearchParams(window.location.search).get('id') || 1;
    const url = `/api/drawGraphBy${by[0].toUpperCase() + by.slice(1)}?${by}Id=${id}`;
    $.get(url).done(function (data) {
      chart.hideLoading();
      chart.setOption({
        title: data.title,
        tooltip: {
          trigger: 'axis',
          position: function (point, params, dom, rect, size) {
            if (point[0] <= size["viewSize"][0] * 0.5) {
              return [point[0], "10%"];
            } else {
              return [point[0] - size["contentSize"][0], "10%"];
            }
          },
        },
        legend: {
          data: data.series.map(function (item) {
            return item.name;
          })
        },
        xAxis: {
          type: 'time',
        },
        yAxis: {
          type: 'value',
          axisLabel: {
            formatter: '{value} ms'
          },
        },
        series: data.series
      });
    });
    $(window).on('resize', function () {
      $('.chart').each(function () {
        var chart = echarts.init(document.getElementById($(this).attr('id')));
        chart.resize();
      });
    });
  </script>
</body>

</html>